SERUAT_HEAD <-readRDS("E:/seq_data/FCA/seuruat_head5_12.rds")
SERUAT_HEAD <- FindNeighbors(object = SERUAT_HEAD, dims = 1:10)
library(edgeR) # BiocManager::install("edgeR")
library(limma)
library(Seurat)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(Matrix)
library(tidyr)
library(stringr)
library("gridExtra")
library(loomR)
SERUAT_HEAD <- FindNeighbors(object = SERUAT_HEAD, dims = 1:10)
library(loomR)
library(Seurat)
library(ggplot2)
library(dplyr)
setwd("E:/seq_data/FCA/")
loom_file <- connect(filename = "s_fca_biohub_antenna_10x.loom", mode = "r+", skip.validate=TRUE)
matrix_data <- as.data.frame(loom_file[["matrix"]][,])
rownames(matrix_data) <- loom_file[["col_attrs/CellID"]][]
colnames(matrix_data) <- loom_file[["row_attrs/Gene"]][]
SERUAT_Antena <- CreateSeuratObject(counts = t(matrix_data), project = "Antena", min.cells = 0, min.features=0)
SERUAT_Antena <- NormalizeData(object = SERUAT_Antena)
SERUAT_Antena <- FindVariableFeatures(object = SERUAT_Antena)
SERUAT_Antena <- ScaleData(object = SERUAT_Antena)
SERUAT_Antena <- RunPCA(object = SERUAT_Antena)
SERUAT_Antena <- RunPCA(object = SERUAT_Antena)
ElbowPlot(SERUAT_Antena)
SERUAT_Antena <- FindNeighbors(object = SERUAT_Antena, dims = 1:20)
SERUAT_Antena <- FindClusters(object = SERUAT_Antena)
SERUAT_Antena <- RunUMAP(object = SERUAT_Antena, dims = 1:20)
saveRDS(SERUAT_Antena, "E:/seq_data/FCA/seuruat_antena6_12.rds")
