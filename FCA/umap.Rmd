---
title: "Untitled"
output: html_document
date: "2023-01-30"
---


```{r}
# install.packages("viridis")
library(viridis)
#install.packages("scCustomize")
library(scCustomize)


SERUAT_HEAD <-readRDS("D:/seq_data/FCA/seuruat_head6_3.rds")


neruon_cell_genes <- c("elav", "NPF", "Syt1", "brp")
list_of_gene_yulia<-c("Dh44","NPF","NPFR","Tdc2","Crz","Trh","trh","fru","Syt1")


#clusters<-DimPlot(SERUAT_HEAD,reduction="umap",pt.size = 1, label = TRUE, label.size = 7,raster = FALSE)



gene_name<-"fru"

pal <- viridis(n = 10, option = "C", direction = -1)

#precnt_name<-paste("percent.",gene_name,sep="")
#SERUAT_HEAD[[precnt_name]] <- PercentageFeatureSet(SERUAT_HEAD,features =gene_name)
#saveRDS(SERUAT_HEAD,file = "D:/seq_data/FCA/seuruat_head6_3.rds")

# THE ORDER IS FOR BETTER VISUAL THAT THEY ARE ON TOP 
ple<-FeaturePlot(SERUAT_HEAD, paste("percent.","ple",sep=""),raster=FALSE,min.cutoff = 0.36,order = T)
NPF<-FeaturePlot(SERUAT_HEAD, paste("percent.","NPF",sep=""),raster=FALSE,min.cutoff = 0.3,order = T)
NPFR<-FeaturePlot(SERUAT_HEAD, paste("percent.","NPFR",sep=""),raster=FALSE,min.cutoff = 0.18,order = T)
Tdc2<-FeaturePlot(SERUAT_HEAD, paste("percent.","Tdc2",sep=""),raster=FALSE,min.cutoff = 0.05,order = T)
Crz<-FeaturePlot(SERUAT_HEAD, paste("percent.","Crz",sep=""),raster=FALSE,min.cutoff = 0.16,order = T)
Tbh<-FeaturePlot(SERUAT_HEAD, paste("percent.","Tbh",sep=""),raster=FALSE,min.cutoff = 0.33,order = T)
fru<-FeaturePlot(SERUAT_HEAD,paste("percent.","fru",sep=""),raster=FALSE,min.cutoff = 0.57,order = T)

#FeaturePlot_scCustom
#brp<-FeaturePlot(SERUAT_HEAD, "brp",raster=FALSE)

#Syt1<-FeaturePlot(SERUAT_HEAD, "Syt1",raster=FALSE)
#fru<-FeaturePlot(SERUAT_HEAD, "fru",raster=FALSE)


plotname<-"C:/Users/lital/OneDrive - Bar Ilan University/Lital/weekly presentation/5.3.23/umap_percent_on_top.tiff"

tiff(file=plotname,units="in",height=13,width=18,res=600)


grid.arrange(ple, NPF, NPFR, Tbh,Tdc2,Crz,fru,ncol=3, nrow =3)

dev.off()


#grid.arrange(clusters, brp, NPFR, Dh44,Tdc2,Syt1, fru,NPF,ncol=4, nrow =2)

#clusters|brp|NPFR|Dh44|Tdc2|Syt1|fru|NPF

clusters <- DimPlot(SERUAT_HEAD, reduction = 'umap', group.by = 'RNA_snn_res.0.1', label = TRUE,raster=FALSE)
condition <- DimPlot(SERUAT_HEAD, reduction = 'umap', group.by = 'tissu',raster=FALSE)+guides(color = guide_legend(override.aes = list(size=1), ncol=2) )+theme(legend.title = element_text(size = 5), 
               legend.text = element_text(size = 5))


DefaultAssay(SERUAT_HEAD)


markers_cluster3 <- FindConservedMarkers(SERUAT_HEAD,
                     ident.1 = 3,
                     grouping.var = 'tissu')

head(markers_cluster3)
```

