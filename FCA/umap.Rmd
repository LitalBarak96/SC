---
title: "Untitled"
output: html_document
date: "2023-01-30"
---


```{r}
library(edgeR) # BiocManager::install("edgeR")
library(limma)
library(Seurat)
library(ggplot2)
library(dplyr)
library(ggplot2)
library(Matrix)
library(tidyr)
library(stringr)
library("gridExtra")


SERUAT_HEAD <-readRDS("D:/seq_data/FCA/seuruat_head5_12.rds")




neruon_cell_genes <- c("elav", "NPF", "Syt1", "brp")
list_of_gene_yulia<-c("Dh44","NPF","NPFR","Tdc2","Crz","Trh","trh","fru","Syt1")


clusters<-DimPlot(SERUAT_HEAD,reduction="umap",pt.size = 1, label = TRUE, label.size = 7,raster = FALSE)

Dh44<-FeaturePlot(SERUAT_HEAD, "Dh44",raster=FALSE)
NPF<-FeaturePlot(SERUAT_HEAD, "NPF",raster=FALSE)
NPFR<-FeaturePlot(SERUAT_HEAD, "NPFR",raster=FALSE)
Tdc2<-FeaturePlot(SERUAT_HEAD, "Tdc2",raster=FALSE)
Crz<-FeaturePlot(SERUAT_HEAD, "Crz",raster=FALSE)
Trh<-FeaturePlot(SERUAT_HEAD, "Trh",raster=FALSE)
fru<-FeaturePlot(SERUAT_HEAD, "fru",raster=FALSE)


#brp<-FeaturePlot(SERUAT_HEAD, "brp",raster=FALSE)

#Syt1<-FeaturePlot(SERUAT_HEAD, "Syt1",raster=FALSE)
#fru<-FeaturePlot(SERUAT_HEAD, "fru",raster=FALSE)



grid.arrange(Dh44, NPF, NPFR, Dh44,Tdc2,Crz, Trh,fru,ncol=3, nrow =3)


#grid.arrange(clusters, brp, NPFR, Dh44,Tdc2,Syt1, fru,NPF,ncol=4, nrow =2)

#clusters|brp|NPFR|Dh44|Tdc2|Syt1|fru|NPF

clusters <- DimPlot(SERUAT_HEAD, reduction = 'umap', group.by = 'RNA_snn_res.0.1', label = TRUE,raster=FALSE)
condition <- DimPlot(SERUAT_HEAD, reduction = 'umap', group.by = 'tissu',raster=FALSE)+guides(color = guide_legend(override.aes = list(size=1), ncol=2) )+theme(legend.title = element_text(size = 5), 
               legend.text = element_text(size = 5))


DefaultAssay(SERUAT_HEAD)


markers_cluster3 <- FindConservedMarkers(SERUAT_HEAD,
                     ident.1 = 3,
                     grouping.var = 'tissu')

head(markers_cluster3)
```

