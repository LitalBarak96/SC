---
title: "Untitled"
author: "lital barak"
date: "2023-04-30"
output: html_document
---
```{r}
SERUAT_HEAD <-readRDS("D:/seq_data/FCA/seuruat_head30_4.rds")



 View(SERUAT_HEAD@meta.data)
SERUAT_HEAD@meta.data$norm_NPF<- FetchData(SERUAT_HEAD, vars = "NPF")

SERUAT_HEAD@meta.data$norm_ple<- FetchData(SERUAT_HEAD, vars = "ple")
SERUAT_HEAD@meta.data$norm_NPFR<- FetchData(SERUAT_HEAD, vars = "NPFR")
SERUAT_HEAD@meta.data$norm_Tdc2<- FetchData(SERUAT_HEAD, vars = "Tdc2")
SERUAT_HEAD@meta.data$norm_Crz<- FetchData(SERUAT_HEAD, vars = "Crz")

SERUAT_HEAD@meta.data$norm_Tbh<- FetchData(SERUAT_HEAD, vars = "Tbh")
SERUAT_HEAD@meta.data$norm_fru<- FetchData(SERUAT_HEAD, vars = "fru")
#saveRDS(SERUAT_HEAD,"D:/seq_data/FCA/seuruat_head30_4.rds")


SERUAT_HEAD@assays$RNA@data
```


#i got from the script of split_cumelative_all_graphs
```{r}

library(spatstat.utils)
library(loomR)
library(Seurat)
library(ggplot2)
library(dplyr)
library(stringr)
library(tidyr)


all_gene_csv<-as.data.frame(read.csv("C:/Users/lital/OneDrive - Bar Ilan University/Lital/weekly presentation/30.4.23/all_genes.csv"))

SERUAT_HEAD$sample <- rownames(SERUAT_HEAD@meta.data)

SERUAT_HEAD$sample<-str_replace(SERUAT_HEAD$sample, "__", "_")

SERUAT_HEAD$sample<-str_replace(SERUAT_HEAD$sample, "-", "_")

SERUAT_HEAD@meta.data <- separate(SERUAT_HEAD@meta.data, col = 'sample', into = c("test",'Barcode','identity', 'Sex'), 
                                  sep = '_')
View(SERUAT_HEAD@meta.data)

SERUAT_HEAD@meta.data$identity<-as.factor(SERUAT_HEAD@meta.data$identity)
new<-SplitObject(SERUAT_HEAD, split.by = "identity")


list_of_gene<-c("ple","NPFR","fru","Tdc2","NPF","Crz","Tbh")


number_of_fca<-c("1","4","5","6","7","8","9","10","11","12","13","14","15")
names_of_fca<-paste("FCA",number_of_fca,sep="")

for(gene in 1 :length(list_of_gene)){
  
for(i in 1:length(new)){
 # names_of_fca[1] <-paste0('^',names_of_fca[1],'$')
 FCA_LIST<- all_gene_csv[all_gene_csv$FCA %in% names_of_fca[i],]
 current_value_threshold<- FCA_LIST[FCA_LIST$Gene %in% list_of_gene[gene],]$value

  
  #all_gene_csv[grepl(names_of_fca[1], all_gene_csv$FCA), ]

}
  
}
```

